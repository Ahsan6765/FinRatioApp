<%- include('partials/header') %>

<h2>DCF Valuation</h2>
<form method="POST" action="/calculate-dcf" class="form-section">
  <label>Initial Cash Flow:</label>
  <input type="number" name="cashFlow" required>

  <label>Growth Rate (%):</label>
  <input type="number" name="growthRate" step="0.01" required>

  <label>Discount Rate (%):</label>
  <input type="number" name="discountRate" step="0.01" required>

  <label>Terminal Growth Rate (%):</label>
  <input type="number" name="terminalGrowth" step="0.01" required>

  <label>Projection Years:</label>
  <input type="number" name="years" required>

  <label>Current Market Price (optional):</label>
  <input type="number" name="marketPrice" step="0.01">

  <button type="submit">Calculate</button>
</form>

<% if (typeof result !== 'undefined') { %>
  <div class="result-box">
    <h3>Intrinsic Value (DCF): Rs <%= result %></h3>
    <% if (marketPrice) { %>
      <p>Market Price: Rs <%= marketPrice %></p>
      <% if (mos) { %>
        <p><strong>Margin of Safety:</strong> <%= mos %>%</p>
        <p class="<%= mos > 0 ? 'positive' : 'negative' %>">
          <%= mos > 0 ? 'Undervalued ✅' : 'Overvalued ❌' %>
        </p>
      <% } %>
    <% } %>
  </div>
<% } %>

<%- include('partials/footer') %>
